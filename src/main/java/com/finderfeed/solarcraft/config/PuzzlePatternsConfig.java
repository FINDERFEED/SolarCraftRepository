package com.finderfeed.solarcraft.config;


import com.finderfeed.solarcraft.content.blocks.blockentities.sun_shard_puzzle.puzzle_template.Puzzle;
import com.finderfeed.solarcraft.content.blocks.blockentities.sun_shard_puzzle.puzzle_tiles.PuzzleTile;
import com.finderfeed.solarcraft.content.blocks.blockentities.sun_shard_puzzle.puzzle_tiles.PuzzleTileTypes;
import com.google.gson.JsonArray;
import com.google.gson.JsonElement;
import com.google.gson.JsonObject;
import com.google.gson.JsonParser;
import com.google.gson.stream.JsonWriter;

import java.io.BufferedWriter;
import java.io.File;
import java.io.FileWriter;
import java.util.Collection;
import java.util.HashMap;
import java.util.Map;


public class PuzzlePatternsConfig extends LegacyJsonConfig {


    private Map<String,TemplateInstance> templates;

    public PuzzlePatternsConfig() {
        super("puzzle_patterns");
    }

    @Override
    public JsonObject defaultJson() {

        JsonObject object = new JsonObject();
        JsonArray array = new JsonArray();
        object.addProperty("_comment","Do not change anything here!!!");
        JsonElement template1 = JsonParser.parseString("{\"tile_extract_amount\": 20,\"template\":[{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"dot\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"corner\",\"rotation\":0,\"fixed\":false},{\"type\":\"corner\",\"rotation\":90,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"dot\",\"rotation\":0,\"fixed\":false},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"line\",\"rotation\":90,\"fixed\":false},{\"type\":\"line\",\"rotation\":90,\"fixed\":false},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"corner\",\"rotation\":0,\"fixed\":true},{\"type\":\"line\",\"rotation\":0,\"fixed\":false},{\"type\":\"corner\",\"rotation\":180,\"fixed\":false},{\"type\":\"corner\",\"rotation\":270,\"fixed\":false},{\"type\":\"line\",\"rotation\":0,\"fixed\":false},{\"type\":\"corner\",\"rotation\":90,\"fixed\":false},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"line\",\"rotation\":90,\"fixed\":false},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"corner\",\"rotation\":0,\"fixed\":true},{\"type\":\"corner\",\"rotation\":90,\"fixed\":false},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"line\",\"rotation\":90,\"fixed\":false},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"troad\",\"rotation\":270,\"fixed\":false},{\"type\":\"line\",\"rotation\":0,\"fixed\":false},{\"type\":\"troad\",\"rotation\":90,\"fixed\":true},{\"type\":\"troad\",\"rotation\":270,\"fixed\":false},{\"type\":\"line\",\"rotation\":0,\"fixed\":false},{\"type\":\"troad\",\"rotation\":90,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"line\",\"rotation\":90,\"fixed\":false},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"corner\",\"rotation\":270,\"fixed\":false},{\"type\":\"corner\",\"rotation\":180,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"line\",\"rotation\":90,\"fixed\":false},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"line\",\"rotation\":90,\"fixed\":false},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"line\",\"rotation\":90,\"fixed\":false},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"corner\",\"rotation\":270,\"fixed\":true},{\"type\":\"line\",\"rotation\":0,\"fixed\":false},{\"type\":\"corner\",\"rotation\":90,\"fixed\":false},{\"type\":\"corner\",\"rotation\":0,\"fixed\":false},{\"type\":\"line\",\"rotation\":0,\"fixed\":true},{\"type\":\"corner\",\"rotation\":180,\"fixed\":false},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"line\",\"rotation\":90,\"fixed\":false},{\"type\":\"line\",\"rotation\":90,\"fixed\":false},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"dot\",\"rotation\":0,\"fixed\":false},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"corner\",\"rotation\":270,\"fixed\":true},{\"type\":\"corner\",\"rotation\":180,\"fixed\":false},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"dot\",\"rotation\":0,\"fixed\":false},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true}]}");
        array.add(template1);
        JsonElement template2 = JsonParser.parseString("{\"tile_extract_amount\": 30,\"template\":[{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"corner\",\"rotation\":0,\"fixed\":false},{\"type\":\"corner\",\"rotation\":90,\"fixed\":false},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"corner\",\"rotation\":0,\"fixed\":false},{\"type\":\"corner\",\"rotation\":90,\"fixed\":false},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"corner\",\"rotation\":0,\"fixed\":true},{\"type\":\"corner\",\"rotation\":90,\"fixed\":false},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"corner\",\"rotation\":270,\"fixed\":true},{\"type\":\"corner\",\"rotation\":180,\"fixed\":false},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"corner\",\"rotation\":0,\"fixed\":true},{\"type\":\"corner\",\"rotation\":180,\"fixed\":false},{\"type\":\"corner\",\"rotation\":270,\"fixed\":false},{\"type\":\"corner\",\"rotation\":90,\"fixed\":false},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"corner\",\"rotation\":270,\"fixed\":false},{\"type\":\"corner\",\"rotation\":180,\"fixed\":false},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"line\",\"rotation\":90,\"fixed\":false},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"line\",\"rotation\":90,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"corner\",\"rotation\":0,\"fixed\":false},{\"type\":\"line\",\"rotation\":0,\"fixed\":false},{\"type\":\"crossroad\",\"rotation\":0,\"fixed\":false},{\"type\":\"line\",\"rotation\":0,\"fixed\":false},{\"type\":\"line\",\"rotation\":0,\"fixed\":true},{\"type\":\"crossroad\",\"rotation\":0,\"fixed\":false},{\"type\":\"line\",\"rotation\":0,\"fixed\":false},{\"type\":\"corner\",\"rotation\":90,\"fixed\":false},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"corner\",\"rotation\":0,\"fixed\":true},{\"type\":\"corner\",\"rotation\":180,\"fixed\":false},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"line\",\"rotation\":90,\"fixed\":false},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"line\",\"rotation\":90,\"fixed\":false},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"corner\",\"rotation\":270,\"fixed\":true},{\"type\":\"corner\",\"rotation\":90,\"fixed\":false},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"corner\",\"rotation\":270,\"fixed\":false},{\"type\":\"corner\",\"rotation\":90,\"fixed\":false},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"line\",\"rotation\":90,\"fixed\":false},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"line\",\"rotation\":90,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"corner\",\"rotation\":0,\"fixed\":false},{\"type\":\"corner\",\"rotation\":180,\"fixed\":false},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"corner\",\"rotation\":270,\"fixed\":false},{\"type\":\"line\",\"rotation\":0,\"fixed\":false},{\"type\":\"crossroad\",\"rotation\":0,\"fixed\":true},{\"type\":\"line\",\"rotation\":0,\"fixed\":false},{\"type\":\"line\",\"rotation\":0,\"fixed\":false},{\"type\":\"crossroad\",\"rotation\":0,\"fixed\":false},{\"type\":\"line\",\"rotation\":0,\"fixed\":false},{\"type\":\"corner\",\"rotation\":180,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"line\",\"rotation\":90,\"fixed\":false},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"line\",\"rotation\":90,\"fixed\":false},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"corner\",\"rotation\":0,\"fixed\":false},{\"type\":\"corner\",\"rotation\":90,\"fixed\":false},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"corner\",\"rotation\":270,\"fixed\":false},{\"type\":\"corner\",\"rotation\":90,\"fixed\":false},{\"type\":\"corner\",\"rotation\":0,\"fixed\":false},{\"type\":\"corner\",\"rotation\":180,\"fixed\":false},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"corner\",\"rotation\":0,\"fixed\":false},{\"type\":\"corner\",\"rotation\":90,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"corner\",\"rotation\":270,\"fixed\":false},{\"type\":\"corner\",\"rotation\":180,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"corner\",\"rotation\":270,\"fixed\":false},{\"type\":\"corner\",\"rotation\":180,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"corner\",\"rotation\":270,\"fixed\":false},{\"type\":\"corner\",\"rotation\":180,\"fixed\":false},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true}]}");
        array.add(template2);
        JsonElement template3 = JsonParser.parseString("{\"tile_extract_amount\":35,\"template\":[{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"corner\",\"rotation\":0,\"fixed\":false},{\"type\":\"line\",\"rotation\":0,\"fixed\":true},{\"type\":\"line\",\"rotation\":0,\"fixed\":false},{\"type\":\"line\",\"rotation\":0,\"fixed\":false},{\"type\":\"line\",\"rotation\":0,\"fixed\":false},{\"type\":\"corner\",\"rotation\":90,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"dead_end\",\"rotation\":0,\"fixed\":false},{\"type\":\"troad\",\"rotation\":90,\"fixed\":false},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"troad\",\"rotation\":270,\"fixed\":false},{\"type\":\"dead_end\",\"rotation\":180,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"troad\",\"rotation\":270,\"fixed\":false},{\"type\":\"dead_end\",\"rotation\":180,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"dead_end\",\"rotation\":0,\"fixed\":false},{\"type\":\"troad\",\"rotation\":90,\"fixed\":false},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"line\",\"rotation\":90,\"fixed\":false},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"line\",\"rotation\":90,\"fixed\":false},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"dead_end\",\"rotation\":0,\"fixed\":false},{\"type\":\"line\",\"rotation\":0,\"fixed\":true},{\"type\":\"troad\",\"rotation\":90,\"fixed\":false},{\"type\":\"corner\",\"rotation\":0,\"fixed\":false},{\"type\":\"line\",\"rotation\":0,\"fixed\":false},{\"type\":\"line\",\"rotation\":0,\"fixed\":false},{\"type\":\"corner\",\"rotation\":90,\"fixed\":true},{\"type\":\"troad\",\"rotation\":270,\"fixed\":false},{\"type\":\"line\",\"rotation\":0,\"fixed\":false},{\"type\":\"dead_end\",\"rotation\":180,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"line\",\"rotation\":90,\"fixed\":false},{\"type\":\"line\",\"rotation\":90,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"line\",\"rotation\":90,\"fixed\":false},{\"type\":\"line\",\"rotation\":90,\"fixed\":false},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"troad\",\"rotation\":270,\"fixed\":false},{\"type\":\"corner\",\"rotation\":180,\"fixed\":false},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"corner\",\"rotation\":270,\"fixed\":true},{\"type\":\"troad\",\"rotation\":90,\"fixed\":false},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"dead_end\",\"rotation\":0,\"fixed\":false},{\"type\":\"troad\",\"rotation\":90,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"troad\",\"rotation\":270,\"fixed\":false},{\"type\":\"dead_end\",\"rotation\":180,\"fixed\":false},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"line\",\"rotation\":90,\"fixed\":false},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"corner\",\"rotation\":0,\"fixed\":false},{\"type\":\"corner\",\"rotation\":90,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"line\",\"rotation\":90,\"fixed\":false},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"corner\",\"rotation\":270,\"fixed\":false},{\"type\":\"line\",\"rotation\":0,\"fixed\":true},{\"type\":\"corner\",\"rotation\":180,\"fixed\":false},{\"type\":\"corner\",\"rotation\":270,\"fixed\":false},{\"type\":\"line\",\"rotation\":0,\"fixed\":false},{\"type\":\"corner\",\"rotation\":180,\"fixed\":false},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true}]}");
        array.add(template3);
        JsonElement template4 = JsonParser.parseString("{\"tile_extract_amount\":30,\"template\":[{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"corner\",\"rotation\":0,\"fixed\":false},{\"type\":\"dead_end\",\"rotation\":180,\"fixed\":false},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"corner\",\"rotation\":0,\"fixed\":false},{\"type\":\"corner\",\"rotation\":90,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"dead_end\",\"rotation\":0,\"fixed\":false},{\"type\":\"corner\",\"rotation\":90,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"line\",\"rotation\":90,\"fixed\":false},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"dead_end\",\"rotation\":0,\"fixed\":true},{\"type\":\"troad\",\"rotation\":90,\"fixed\":false},{\"type\":\"troad\",\"rotation\":270,\"fixed\":false},{\"type\":\"dead_end\",\"rotation\":180,\"fixed\":false},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"line\",\"rotation\":90,\"fixed\":false},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"line\",\"rotation\":90,\"fixed\":false},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"line\",\"rotation\":90,\"fixed\":false},{\"type\":\"line\",\"rotation\":90,\"fixed\":false},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"line\",\"rotation\":90,\"fixed\":false},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"line\",\"rotation\":90,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"dead_end\",\"rotation\":0,\"fixed\":false},{\"type\":\"troad\",\"rotation\":90,\"fixed\":false},{\"type\":\"troad\",\"rotation\":270,\"fixed\":true},{\"type\":\"dead_end\",\"rotation\":180,\"fixed\":false},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"line\",\"rotation\":90,\"fixed\":false},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"corner\",\"rotation\":270,\"fixed\":false},{\"type\":\"dead_end\",\"rotation\":180,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"line\",\"rotation\":90,\"fixed\":false},{\"type\":\"line\",\"rotation\":90,\"fixed\":false},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"dead_end\",\"rotation\":0,\"fixed\":false},{\"type\":\"corner\",\"rotation\":180,\"fixed\":false},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"corner\",\"rotation\":0,\"fixed\":false},{\"type\":\"corner\",\"rotation\":180,\"fixed\":false},{\"type\":\"corner\",\"rotation\":270,\"fixed\":false},{\"type\":\"corner\",\"rotation\":90,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"line\",\"rotation\":90,\"fixed\":false},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"line\",\"rotation\":90,\"fixed\":false},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"corner\",\"rotation\":0,\"fixed\":false},{\"type\":\"corner\",\"rotation\":180,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"corner\",\"rotation\":270,\"fixed\":false},{\"type\":\"corner\",\"rotation\":90,\"fixed\":false},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"corner\",\"rotation\":0,\"fixed\":false},{\"type\":\"line\",\"rotation\":0,\"fixed\":false},{\"type\":\"corner\",\"rotation\":180,\"fixed\":false},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"corner\",\"rotation\":270,\"fixed\":false},{\"type\":\"line\",\"rotation\":0,\"fixed\":false},{\"type\":\"corner\",\"rotation\":90,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"corner\",\"rotation\":270,\"fixed\":true},{\"type\":\"line\",\"rotation\":0,\"fixed\":false},{\"type\":\"line\",\"rotation\":0,\"fixed\":false},{\"type\":\"line\",\"rotation\":0,\"fixed\":false},{\"type\":\"line\",\"rotation\":0,\"fixed\":false},{\"type\":\"line\",\"rotation\":0,\"fixed\":false},{\"type\":\"line\",\"rotation\":0,\"fixed\":false},{\"type\":\"line\",\"rotation\":0,\"fixed\":true},{\"type\":\"line\",\"rotation\":0,\"fixed\":false},{\"type\":\"corner\",\"rotation\":180,\"fixed\":false},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true}]}");
        array.add(template4);
        JsonElement template5 = JsonParser.parseString("{\"tile_extract_amount\":35,\"template\":[{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"corner\",\"rotation\":0,\"fixed\":false},{\"type\":\"corner\",\"rotation\":90,\"fixed\":false},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"corner\",\"rotation\":0,\"fixed\":true},{\"type\":\"corner\",\"rotation\":90,\"fixed\":false},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"corner\",\"rotation\":0,\"fixed\":true},{\"type\":\"corner\",\"rotation\":90,\"fixed\":false},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"corner\",\"rotation\":270,\"fixed\":false},{\"type\":\"crossroad\",\"rotation\":0,\"fixed\":false},{\"type\":\"corner\",\"rotation\":90,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"line\",\"rotation\":90,\"fixed\":false},{\"type\":\"line\",\"rotation\":90,\"fixed\":false},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"corner\",\"rotation\":0,\"fixed\":false},{\"type\":\"crossroad\",\"rotation\":0,\"fixed\":false},{\"type\":\"corner\",\"rotation\":180,\"fixed\":false},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"corner\",\"rotation\":270,\"fixed\":false},{\"type\":\"crossroad\",\"rotation\":0,\"fixed\":false},{\"type\":\"corner\",\"rotation\":90,\"fixed\":false},{\"type\":\"line\",\"rotation\":90,\"fixed\":false},{\"type\":\"line\",\"rotation\":90,\"fixed\":false},{\"type\":\"corner\",\"rotation\":0,\"fixed\":false},{\"type\":\"crossroad\",\"rotation\":0,\"fixed\":true},{\"type\":\"corner\",\"rotation\":180,\"fixed\":false},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"corner\",\"rotation\":270,\"fixed\":false},{\"type\":\"crossroad\",\"rotation\":0,\"fixed\":true},{\"type\":\"troad\",\"rotation\":180,\"fixed\":false},{\"type\":\"troad\",\"rotation\":180,\"fixed\":false},{\"type\":\"crossroad\",\"rotation\":0,\"fixed\":false},{\"type\":\"corner\",\"rotation\":180,\"fixed\":false},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"corner\",\"rotation\":0,\"fixed\":false},{\"type\":\"line\",\"rotation\":180,\"fixed\":true},{\"type\":\"line\",\"rotation\":180,\"fixed\":false},{\"type\":\"troad\",\"rotation\":90,\"fixed\":false},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"troad\",\"rotation\":270,\"fixed\":true},{\"type\":\"line\",\"rotation\":180,\"fixed\":false},{\"type\":\"line\",\"rotation\":180,\"fixed\":false},{\"type\":\"corner\",\"rotation\":90,\"fixed\":false},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"corner\",\"rotation\":270,\"fixed\":false},{\"type\":\"line\",\"rotation\":180,\"fixed\":false},{\"type\":\"line\",\"rotation\":180,\"fixed\":false},{\"type\":\"troad\",\"rotation\":90,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"troad\",\"rotation\":270,\"fixed\":false},{\"type\":\"line\",\"rotation\":180,\"fixed\":false},{\"type\":\"line\",\"rotation\":180,\"fixed\":false},{\"type\":\"corner\",\"rotation\":180,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"corner\",\"rotation\":0,\"fixed\":false},{\"type\":\"crossroad\",\"rotation\":0,\"fixed\":false},{\"type\":\"troad\",\"rotation\":0,\"fixed\":false},{\"type\":\"troad\",\"rotation\":0,\"fixed\":true},{\"type\":\"crossroad\",\"rotation\":0,\"fixed\":false},{\"type\":\"corner\",\"rotation\":90,\"fixed\":false},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"corner\",\"rotation\":0,\"fixed\":false},{\"type\":\"crossroad\",\"rotation\":0,\"fixed\":false},{\"type\":\"corner\",\"rotation\":180,\"fixed\":false},{\"type\":\"line\",\"rotation\":270,\"fixed\":false},{\"type\":\"line\",\"rotation\":270,\"fixed\":false},{\"type\":\"corner\",\"rotation\":270,\"fixed\":false},{\"type\":\"crossroad\",\"rotation\":0,\"fixed\":false},{\"type\":\"corner\",\"rotation\":90,\"fixed\":false},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"corner\",\"rotation\":0,\"fixed\":false},{\"type\":\"crossroad\",\"rotation\":0,\"fixed\":true},{\"type\":\"corner\",\"rotation\":180,\"fixed\":false},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"line\",\"rotation\":270,\"fixed\":false},{\"type\":\"line\",\"rotation\":270,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"corner\",\"rotation\":270,\"fixed\":false},{\"type\":\"crossroad\",\"rotation\":0,\"fixed\":false},{\"type\":\"corner\",\"rotation\":90,\"fixed\":false},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"corner\",\"rotation\":270,\"fixed\":false},{\"type\":\"corner\",\"rotation\":180,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"corner\",\"rotation\":270,\"fixed\":false},{\"type\":\"corner\",\"rotation\":180,\"fixed\":false},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"corner\",\"rotation\":270,\"fixed\":false},{\"type\":\"corner\",\"rotation\":180,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true},{\"type\":\"null\",\"rotation\":0,\"fixed\":true}]}");
        array.add(template5);
        object.add("templates",array);
        return object;
    }

    @Override
    public void deserialize(JsonObject json) {
        JsonArray array = json.getAsJsonArray("templates");
        int index = 1;
        templates = new HashMap<>();
        for (JsonElement e : array){
            TemplateInstance templateInstance = loadTemplate(e, Puzzle.PUZZLE_SIZE);
            templates.put("template_" + index,templateInstance);
            index++;
        }
    }

    private TemplateInstance loadTemplate(JsonElement element, int size){
        JsonArray array = element.getAsJsonObject().getAsJsonArray("template");

        PuzzleTile[][] puzzleTiles = new PuzzleTile[size][size];
        for (int y = 0;y < size;y++){
            for (int x = 0;x < size;x++){
                PuzzleTile tile = fromJson(array.get(y * size + x).getAsJsonObject());
                puzzleTiles[y][x] = tile;
            }
        }
        return new TemplateInstance(puzzleTiles,element.getAsJsonObject().get("tile_extract_amount").getAsInt());
    }


    private PuzzleTile fromJson(JsonObject element){
        if (element.get("type").getAsString().equals("empty")){
            return null;
        }
        return new PuzzleTile(
                PuzzleTileTypes.getTileById(element.get("type").getAsString()),
                element.get("rotation").getAsInt(),
                element.get("fixed").getAsBoolean()
        );
    }

    public static void exportTemplate(PuzzleTile[][] template,String path,int tileExtractAmount){
        try {
            File file = new File(path);
            if (!file.exists()) {
                file.createNewFile();
            }

            JsonObject jsonObject = new JsonObject();
            jsonObject.addProperty("tile_extract_amount",tileExtractAmount);
            JsonArray array = new JsonArray();
            for (int y = 0; y < template.length;y++){
                for (int x = 0; x < template[y].length;x++){
                    array.add(tileToJson(template[y][x]));
                }
            }
            jsonObject.add("template",array);

            JsonWriter writer = GSON.newJsonWriter(new BufferedWriter(new FileWriter(file)));
            GSON.toJson(jsonObject,writer);
            writer.close();
        }catch (Exception e){
            e.printStackTrace();
        }
    }

    private static JsonObject tileToJson(PuzzleTile tile){
        if (tile == null){
            JsonObject object = new JsonObject();
            object.addProperty("type","empty");
            return object;
        }
        JsonObject object = new JsonObject();
        object.addProperty("type",tile.getTileType().getName());
        object.addProperty("rotation",tile.getRotation());
        object.addProperty("fixed",tile.isFixed());
        return object;
    }

    public TemplateInstance getDefaultTemplate(String id){
        return templates.get(id);
    }

    public Collection<String> getAllTemplates(){
        return templates.keySet();
    }
    public record TemplateInstance(PuzzleTile[][] template,int tileExtractAmount){};
}
